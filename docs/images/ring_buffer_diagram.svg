<svg viewBox="0 0 1000 750" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#374151"/>
    </marker>
    <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3B82F6"/>
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#10B981"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="1000" height="750" fill="#f8fafc"/>
  
  <!-- Title -->
  <text x="500" y="35" text-anchor="middle" font-family="system-ui, sans-serif" font-size="24" font-weight="bold" fill="#1e293b">Ring Buffer: Write &amp; Read Index Timeline</text>
  
  <!-- Column Headers -->
  <text x="40" y="75" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="#64748b">TIME</text>
  <text x="140" y="75" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="#3B82F6">PUBLISHER</text>
  <text x="400" y="75" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="#6B7280">RING BUFFER</text>
  <text x="680" y="75" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="#10B981">SUBSCRIBER</text>
  <text x="880" y="75" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="#7c3aed">INDICES</text>
  
  <!-- Vertical divider lines -->
  <line x1="100" y1="85" x2="100" y2="700" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="4"/>
  <line x1="300" y1="85" x2="300" y2="700" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="4"/>
  <line x1="600" y1="85" x2="600" y2="700" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="4"/>
  <line x1="820" y1="85" x2="820" y2="700" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="4"/>
  
  <!-- ==================== T0: Initial State ==================== -->
  <line x1="20" y1="95" x2="980" y2="95" stroke="#e2e8f0" stroke-width="1"/>
  
  <text x="40" y="130" font-family="monospace" font-size="16" font-weight="bold" fill="#374151">T0</text>
  
  <text x="140" y="130" font-family="system-ui, sans-serif" font-size="12" fill="#6B7280">(starting)</text>
  
  <!-- Ring buffer T0 -->
  <g transform="translate(320, 110)">
    <rect x="0" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <rect x="60" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <rect x="120" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <rect x="180" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <text x="27" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
    <text x="87" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
    <text x="147" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
    <text x="207" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
    <text x="27" y="48" text-anchor="middle" font-family="monospace" font-size="9" fill="#64748b">0</text>
    <text x="87" y="48" text-anchor="middle" font-family="monospace" font-size="9" fill="#64748b">1</text>
    <text x="147" y="48" text-anchor="middle" font-family="monospace" font-size="9" fill="#64748b">2</text>
    <text x="207" y="48" text-anchor="middle" font-family="monospace" font-size="9" fill="#64748b">3</text>
  </g>
  
  <text x="680" y="130" font-family="system-ui, sans-serif" font-size="12" fill="#6B7280">(not started)</text>
  
  <!-- Indices T0 -->
  <rect x="840" y="108" width="130" height="45" fill="#f5f3ff" stroke="#a78bfa" stroke-width="2" rx="6"/>
  <text x="905" y="126" text-anchor="middle" font-family="monospace" font-size="11" fill="#7c3aed">write_idx = 0</text>
  <text x="905" y="144" text-anchor="middle" font-family="monospace" font-size="11" fill="#9ca3af">read_idx = —</text>
  
  <!-- ==================== T1: First Write ==================== -->
  <line x1="20" y1="170" x2="980" y2="170" stroke="#e2e8f0" stroke-width="1"/>
  
  <text x="40" y="220" font-family="monospace" font-size="16" font-weight="bold" fill="#374151">T1</text>
  
  <!-- Publisher action T1 -->
  <rect x="110" y="185" width="150" height="55" fill="#dbeafe" stroke="#3B82F6" stroke-width="2" rx="6"/>
  <text x="185" y="207" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#1e40af">publish("Hello")</text>
  <text x="185" y="225" text-anchor="middle" font-family="monospace" font-size="10" fill="#3B82F6">slot 0, seq=0</text>
  
  <!-- Arrow to ring buffer T1 -->
  <line x1="260" y1="212" x2="315" y2="212" stroke="#3B82F6" stroke-width="2" marker-end="url(#arrowhead-blue)"/>
  
  <!-- Ring buffer T1 -->
  <g transform="translate(320, 195)">
    <rect x="0" y="0" width="55" height="32" fill="#bfdbfe" stroke="#3B82F6" stroke-width="2" rx="4"/>
    <rect x="60" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <rect x="120" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <rect x="180" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <text x="27" y="13" text-anchor="middle" font-family="monospace" font-size="8" fill="#1e40af">seq=0</text>
    <text x="27" y="25" text-anchor="middle" font-family="monospace" font-size="9" font-weight="bold" fill="#1e40af">"Hello"</text>
    <text x="87" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
    <text x="147" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
    <text x="207" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
  </g>
  
  <text x="680" y="215" font-family="system-ui, sans-serif" font-size="12" fill="#6B7280">(not started)</text>
  
  <!-- Indices T1 -->
  <rect x="840" y="193" width="130" height="45" fill="#f5f3ff" stroke="#a78bfa" stroke-width="2" rx="6"/>
  <text x="905" y="211" text-anchor="middle" font-family="monospace" font-size="11" font-weight="bold" fill="#7c3aed">write_idx = 1</text>
  <text x="905" y="229" text-anchor="middle" font-family="monospace" font-size="11" fill="#9ca3af">read_idx = —</text>
  
  <!-- ==================== T2: Subscriber Starts ==================== -->
  <line x1="20" y1="255" x2="980" y2="255" stroke="#e2e8f0" stroke-width="1"/>
  
  <text x="40" y="310" font-family="monospace" font-size="16" font-weight="bold" fill="#374151">T2</text>
  
  <text x="185" y="310" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="#6B7280">(idle)</text>
  
  <!-- Ring buffer T2 -->
  <g transform="translate(320, 285)">
    <rect x="0" y="0" width="55" height="32" fill="#bfdbfe" stroke="#3B82F6" stroke-width="2" rx="4"/>
    <rect x="60" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <rect x="120" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <rect x="180" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <text x="27" y="13" text-anchor="middle" font-family="monospace" font-size="8" fill="#1e40af">seq=0</text>
    <text x="27" y="25" text-anchor="middle" font-family="monospace" font-size="9" font-weight="bold" fill="#1e40af">"Hello"</text>
    <text x="87" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
    <text x="147" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
    <text x="207" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
  </g>
  
  <!-- Arrow from ring buffer to subscriber T2 -->
  <line x1="560" y1="301" x2="610" y2="301" stroke="#10B981" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  
  <!-- Subscriber action T2 -->
  <rect x="615" y="270" width="175" height="70" fill="#d1fae5" stroke="#10B981" stroke-width="2" rx="6"/>
  <text x="702" y="290" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#065f46">Subscriber starts</text>
  <text x="702" y="308" text-anchor="middle" font-family="monospace" font-size="10" fill="#10B981">0 &lt; 1? YES!</text>
  <text x="702" y="323" text-anchor="middle" font-family="monospace" font-size="10" fill="#059669">Read slot 0 ✓</text>
  <text x="702" y="336" text-anchor="middle" font-family="monospace" font-size="10" fill="#059669">Got "Hello"</text>
  
  <!-- Indices T2 -->
  <rect x="840" y="283" width="130" height="45" fill="#f5f3ff" stroke="#a78bfa" stroke-width="2" rx="6"/>
  <text x="905" y="301" text-anchor="middle" font-family="monospace" font-size="11" fill="#7c3aed">write_idx = 1</text>
  <text x="905" y="319" text-anchor="middle" font-family="monospace" font-size="11" font-weight="bold" fill="#7c3aed">read_idx = 1</text>
  
  <!-- ==================== T3: Caught Up ==================== -->
  <line x1="20" y1="355" x2="980" y2="355" stroke="#e2e8f0" stroke-width="1"/>
  
  <text x="40" y="410" font-family="monospace" font-size="16" font-weight="bold" fill="#374151">T3</text>
  
  <text x="185" y="410" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="#6B7280">(idle)</text>
  
  <!-- Ring buffer T3 -->
  <g transform="translate(320, 385)">
    <rect x="0" y="0" width="55" height="32" fill="#e0e7ff" stroke="#a5b4fc" stroke-width="2" rx="4"/>
    <rect x="60" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <rect x="120" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <rect x="180" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <text x="27" y="13" text-anchor="middle" font-family="monospace" font-size="8" fill="#6366f1">seq=0</text>
    <text x="27" y="25" text-anchor="middle" font-family="monospace" font-size="9" fill="#6366f1">"Hello"</text>
    <text x="87" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
    <text x="147" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
    <text x="207" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
  </g>
  
  <!-- Subscriber waiting T3 -->
  <rect x="615" y="380" width="175" height="45" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" rx="6"/>
  <text x="702" y="400" text-anchor="middle" font-family="monospace" font-size="10" fill="#b45309">1 &lt; 1? NO</text>
  <text x="702" y="418" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" fill="#b45309">⏳ Waiting...</text>
  
  <!-- Indices T3 -->
  <rect x="840" y="383" width="130" height="45" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" rx="6"/>
  <text x="905" y="401" text-anchor="middle" font-family="monospace" font-size="11" fill="#b45309">write_idx = 1</text>
  <text x="905" y="419" text-anchor="middle" font-family="monospace" font-size="11" fill="#b45309">read_idx = 1</text>
  
  <!-- ==================== T4: Second Write ==================== -->
  <line x1="20" y1="445" x2="980" y2="445" stroke="#e2e8f0" stroke-width="1"/>
  
  <text x="40" y="510" font-family="monospace" font-size="16" font-weight="bold" fill="#374151">T4</text>
  
  <!-- Publisher action T4 -->
  <rect x="110" y="470" width="150" height="55" fill="#dbeafe" stroke="#3B82F6" stroke-width="2" rx="6"/>
  <text x="185" y="492" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#1e40af">publish("World")</text>
  <text x="185" y="510" text-anchor="middle" font-family="monospace" font-size="10" fill="#3B82F6">slot 1, seq=1</text>
  
  <!-- Arrow to ring buffer T4 -->
  <line x1="260" y1="497" x2="315" y2="497" stroke="#3B82F6" stroke-width="2" marker-end="url(#arrowhead-blue)"/>
  
  <!-- Ring buffer T4 -->
  <g transform="translate(320, 480)">
    <rect x="0" y="0" width="55" height="32" fill="#e0e7ff" stroke="#a5b4fc" stroke-width="2" rx="4"/>
    <rect x="60" y="0" width="55" height="32" fill="#bfdbfe" stroke="#3B82F6" stroke-width="2" rx="4"/>
    <rect x="120" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <rect x="180" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <text x="27" y="13" text-anchor="middle" font-family="monospace" font-size="8" fill="#6366f1">seq=0</text>
    <text x="27" y="25" text-anchor="middle" font-family="monospace" font-size="9" fill="#6366f1">"Hello"</text>
    <text x="87" y="13" text-anchor="middle" font-family="monospace" font-size="8" fill="#1e40af">seq=1</text>
    <text x="87" y="25" text-anchor="middle" font-family="monospace" font-size="9" font-weight="bold" fill="#1e40af">"World"</text>
    <text x="147" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
    <text x="207" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
  </g>
  
  <!-- Wake arrow T4 -->
  <path d="M 558 496 Q 580 470 615 475" fill="none" stroke="#10B981" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <text x="575" y="462" font-family="system-ui, sans-serif" font-size="10" fill="#10B981">wake!</text>
  
  <!-- Subscriber action T4 -->
  <rect x="615" y="465" width="175" height="55" fill="#d1fae5" stroke="#10B981" stroke-width="2" rx="6"/>
  <text x="702" y="485" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#065f46">⚡ Wakes up!</text>
  <text x="702" y="503" text-anchor="middle" font-family="monospace" font-size="10" fill="#10B981">1 &lt; 2? YES!</text>
  <text x="702" y="516" text-anchor="middle" font-family="monospace" font-size="10" fill="#059669">Got "World" ✓</text>
  
  <!-- Indices T4 -->
  <rect x="840" y="478" width="130" height="45" fill="#f5f3ff" stroke="#a78bfa" stroke-width="2" rx="6"/>
  <text x="905" y="496" text-anchor="middle" font-family="monospace" font-size="11" font-weight="bold" fill="#7c3aed">write_idx = 2</text>
  <text x="905" y="514" text-anchor="middle" font-family="monospace" font-size="11" font-weight="bold" fill="#7c3aed">read_idx = 2</text>
  
  <!-- ==================== T5: Caught Up Again ==================== -->
  <line x1="20" y1="540" x2="980" y2="540" stroke="#e2e8f0" stroke-width="1"/>
  
  <text x="40" y="595" font-family="monospace" font-size="16" font-weight="bold" fill="#374151">T5</text>
  
  <text x="185" y="595" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="#6B7280">(idle)</text>
  
  <!-- Ring buffer T5 -->
  <g transform="translate(320, 570)">
    <rect x="0" y="0" width="55" height="32" fill="#e0e7ff" stroke="#a5b4fc" stroke-width="2" rx="4"/>
    <rect x="60" y="0" width="55" height="32" fill="#e0e7ff" stroke="#a5b4fc" stroke-width="2" rx="4"/>
    <rect x="120" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <rect x="180" y="0" width="55" height="32" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="2" rx="4"/>
    <text x="27" y="13" text-anchor="middle" font-family="monospace" font-size="8" fill="#6366f1">seq=0</text>
    <text x="27" y="25" text-anchor="middle" font-family="monospace" font-size="9" fill="#6366f1">"Hello"</text>
    <text x="87" y="13" text-anchor="middle" font-family="monospace" font-size="8" fill="#6366f1">seq=1</text>
    <text x="87" y="25" text-anchor="middle" font-family="monospace" font-size="9" fill="#6366f1">"World"</text>
    <text x="147" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
    <text x="207" y="20" text-anchor="middle" font-family="monospace" font-size="10" fill="#94a3b8">empty</text>
  </g>
  
  <!-- Subscriber waiting T5 -->
  <rect x="615" y="570" width="175" height="45" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" rx="6"/>
  <text x="702" y="590" text-anchor="middle" font-family="monospace" font-size="10" fill="#b45309">2 &lt; 2? NO</text>
  <text x="702" y="608" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" fill="#b45309">⏳ Waiting...</text>
  
  <!-- Indices T5 -->
  <rect x="840" y="573" width="130" height="45" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" rx="6"/>
  <text x="905" y="591" text-anchor="middle" font-family="monospace" font-size="11" fill="#b45309">write_idx = 2</text>
  <text x="905" y="609" text-anchor="middle" font-family="monospace" font-size="11" fill="#b45309">read_idx = 2</text>
  
  <!-- ==================== Legend ==================== -->
  <line x1="20" y1="635" x2="980" y2="635" stroke="#e2e8f0" stroke-width="1"/>
  
  <g transform="translate(100, 665)">
    <rect x="0" y="0" width="18" height="18" fill="#bfdbfe" stroke="#3B82F6" stroke-width="1" rx="3"/>
    <text x="25" y="14" font-family="system-ui, sans-serif" font-size="11" fill="#374151">New write</text>
    
    <rect x="130" y="0" width="18" height="18" fill="#e0e7ff" stroke="#a5b4fc" stroke-width="1" rx="3"/>
    <text x="155" y="14" font-family="system-ui, sans-serif" font-size="11" fill="#374151">Old data</text>
    
    <rect x="260" y="0" width="18" height="18" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1" rx="3"/>
    <text x="285" y="14" font-family="system-ui, sans-serif" font-size="11" fill="#374151">Empty</text>
    
    <rect x="380" y="0" width="18" height="18" fill="#d1fae5" stroke="#10B981" stroke-width="1" rx="3"/>
    <text x="405" y="14" font-family="system-ui, sans-serif" font-size="11" fill="#374151">Subscriber read</text>
    
    <rect x="540" y="0" width="18" height="18" fill="#fef3c7" stroke="#f59e0b" stroke-width="1" rx="3"/>
    <text x="565" y="14" font-family="system-ui, sans-serif" font-size="11" fill="#374151">Waiting (caught up)</text>
  </g>
</svg>
